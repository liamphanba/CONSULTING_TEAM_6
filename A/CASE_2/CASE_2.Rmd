---
title: "CASE 2 - Aanaesthetics"
author: Liam Phan, Michael Bigler, Tania Loureiro, William Elkiess, Dakota Cuellar
  and Ilyana El Mendili
date: "2023-03-10"
output: 
  rmdformats::downcute:
    code_folding: hide
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE, warning = FALSE,comment = FALSE, error = FALSE,options(scipen=999))
rm(list = ls())

```

# Client Case

> A study was carried out at a hospital to compare the effects of four different types of anaesthetic as used in major operations.
>
> 80 patients undergoing a variety of operations were randomly assigned to one of the four anaesthetics and a variety of observations were taken on each patient both before and after the operation.
>
> 1.  The client is interested on just one of the measurements made, namely the time, in minutes, from the reversal of the anaesthetic until the patient opened the eyes.
> 2.  The client would like to know if there is any evidence of differences between the effects of the four anaesthetics?

# Packages

```{r Packages}

library(ggplot2)
library(data.table)
library(tidyverse)
library(reshape)
library(DT)
library(gtsummary)
library(psych)


```

# Dataset

```{r Dataset}

Aanaesthetics <- fread("Aanaesthetics.txt")
Aanaesthetics <- as_data_frame(Aanaesthetics)

Aanaesthetics_Pivoted <- Aanaesthetics %>% 
  pivot_longer(
    cols = c("A","B","C","D"), 
    names_to = "Anaesthetic", 
    values_to = "Time")

length(Aanaesthetics_Pivoted$Anaesthetic)

Aanaesthetics_Pivoted$Patient <- seq(1,length(Aanaesthetics_Pivoted$Anaesthetic))

col_order <- c("Patient", "Time", "Anaesthetic")
Aanaesthetics_Pivoted <- Aanaesthetics_Pivoted[, col_order]

datatable(Aanaesthetics)
datatable(Aanaesthetics_Pivoted)
                              
```

# 1. Data Exploratory Analysis

```{r Summary Statistics}


```

```{r Outliers}

Weird_Patient <- Aanaesthetics_Pivoted[Aanaesthetics_Pivoted$Time == 0,]

Weird_Patient

```

> Weird Patient having 0 Minute


```{r Boxplots}

Boxplot <- ggplot(Aanaesthetics_Pivoted) +
 aes(x = Anaesthetic, y = Time, fill=Anaesthetic) +
 geom_boxplot() + scale_fill_manual(values=c("#294C60", "#648767", "#7776BC","#967D69")) + labs(title = "Boxplots", subtitle = "Aanesthetics", caption = "©2023 Alpine Insights", y="Minutes") +  theme_minimal() + theme(plot.title = element_text(face = "bold")) + theme(legend.position = "none") + theme(axis.text.x=element_text(size=15,face = "bold")) + theme(axis.title = element_text(size =12))  

Boxplot

```

```{r Histograms}

Histograms <- Aanaesthetics_Pivoted %>% ggplot( aes(x=Time, fill=Anaesthetic)) + geom_histogram( color="#e9ecef", alpha=1, position = 'identity', binwidth = 1) + scale_fill_manual(values=c("#294C60", "#648767", "#7776BC","#967D69")) + theme_minimal() + labs(fill="") + facet_wrap(~Anaesthetic) + theme(plot.title = element_text(face = "bold")) + labs(title = "Histograms", subtitle = "Aanesthetics", caption = "©2023 Alpine Insights", y="Count") + theme(legend.position = "none") + theme(axis.title = element_text(size =12)) + theme(strip.text.x = element_text(size = 12,face = "bold"))         
Histograms

```

# 2. Core Analysis

## Anova Test

```{r Anova Test}

ANOVA <- aov(Time ~ Anaesthetic, data = Aanaesthetics_Pivoted)

ANOVA_Summary <- summary(ANOVA)

ANOVA_Summary

```

## Check Assumptions

> 1.  Homoskedasticity
>
> ```{=html}
> <!-- -->
> ```
> 2.  Normality



### Anova Checks

```{r Anova Checks}

# Plot ANOVA Residuals
par(mfrow=c(2,2))
plot(ANOVA)
par(mfrow=c(1,1))

# Extract the residuals
ANOVA_Residuals <- residuals(object = ANOVA )

# Run Shapiro-Wilk test
shapiro.test(x = ANOVA_Residuals )

# Kruskal-Wallis rank sum test, which can be used when ANNOVA assumptions are not met
kruskal.test(Time ~ Anaesthetic, data = Aanaesthetics_Pivoted)

```


# Results

```{r Resuts}




```

# References

[One-Way ANOVA Test in R](http://www.sthda.com/english/wiki/one-way-anova-test-in-r)


